

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>brian_red &mdash; brian 0.1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="brian 0.1.1 documentation" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> brian
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing brian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running brian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledge.html">Acknowledging brian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/modules.html">Functions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">brian</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Module code</a> &raquo;</li>
      
    <li>brian_red</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for brian_red</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># This file contains several function and tools used by the BRIAN routines to correct</span>
<span class="c1"># emission line fluxes for galactic and extragalactic reddening.</span>
<span class="c1">#</span>
<span class="c1"># Created April 2016, F.P.A. Vogt - frederic.vogt@alumni.anu.edu.au</span>
<span class="c1"># ----------------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span> <span class="kn">as</span> <span class="nn">interpolate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">as</span> <span class="nn">gridspec</span>

<span class="kn">from</span> <span class="nn">brian_metadata</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># ----------------------------------------------------------------------------------------      </span>

<div class="viewcode-block" id="D_fm90"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.D_fm90">[docs]</a><span class="k">def</span> <span class="nf">D_fm90</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">x0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">    The UV points from Fitzpatrick &amp; Massa (1990). x is in 1/microns</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">x0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>
     
<div class="viewcode-block" id="F_fm90"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.F_fm90">[docs]</a><span class="k">def</span> <span class="nf">F_fm90</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The UV points from Fitzpatrick &amp; Massa (1990). x is in 1/microns</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="mf">5.9</span><span class="p">:</span>    
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5392</span><span class="o">*</span><span class="p">(</span><span class="n">item</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.05644</span><span class="o">*</span><span class="p">(</span><span class="n">item</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">out</span></div>
<span class="c1"># ----------------------------------------------------------------------------------------  </span>
            
<div class="viewcode-block" id="f99_alebv"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.f99_alebv">[docs]</a><span class="k">def</span> <span class="nf">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.1</span><span class="p">):</span> <span class="c1"># lams in Angstroem</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The spline-interpolated Fitzpatrick, PASP (1999) Alambda/E(B-V) function.</span>
<span class="sd">    lams in Ansgtroem</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">my_lams</span> <span class="o">=</span> <span class="mf">1.0e4</span><span class="o">/</span><span class="n">lams</span> 
     
    <span class="c1"># Make sure this is an array, or the code will crash</span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">my_lams</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="n">my_lams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">my_lams</span><span class="p">])</span>
       
    <span class="c1"># First, the anchor points (in 1/lambda)</span>
    <span class="n">uv_anchors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.704</span><span class="p">,</span><span class="mf">3.846</span><span class="p">])</span>
    <span class="n">optical_anchors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.667</span><span class="p">,</span> <span class="mf">1.828</span><span class="p">,</span> <span class="mf">2.141</span><span class="p">,</span> <span class="mf">2.433</span><span class="p">])</span>
    <span class="n">ir_anchors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.377</span><span class="p">,</span> <span class="mf">0.820</span><span class="p">])</span>    
             
    <span class="c1"># ---- The parameters for the UV points ----</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.824</span> <span class="o">+</span> <span class="mf">4.717</span><span class="o">/</span><span class="n">rv</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="mf">2.030</span> <span class="o">-</span> <span class="mf">3.007</span> <span class="o">*</span> <span class="n">c2</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="mf">4.596</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.99</span>
    <span class="n">c3</span> <span class="o">=</span> <span class="mf">3.23</span>
    <span class="n">c4</span> <span class="o">=</span> <span class="mf">0.41</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">D_fm90</span><span class="p">(</span><span class="n">uv_anchors</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">F_fm90</span><span class="p">(</span><span class="n">uv_anchors</span><span class="p">)</span>    
    <span class="n">kx_V</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">uv_anchors</span> <span class="o">+</span> <span class="n">c3</span> <span class="o">*</span> <span class="n">D</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">*</span> <span class="n">F</span>
    <span class="n">uv_spline</span> <span class="o">=</span> <span class="n">kx_V</span> <span class="o">+</span> <span class="n">rv</span>
    
    <span class="c1"># ---- For the optical anchors ----</span>
    <span class="n">optical_spline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">optical_anchors</span><span class="p">)</span>
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.426</span> <span class="o">+</span> <span class="mf">1.0044</span> <span class="o">*</span> <span class="n">rv</span>
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.050</span> <span class="o">+</span> <span class="mf">1.0016</span> <span class="o">*</span> <span class="n">rv</span>
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.701</span> <span class="o">+</span> <span class="mf">1.0016</span> <span class="o">*</span> <span class="n">rv</span> 
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.208</span> <span class="o">+</span> <span class="mf">1.0032</span> <span class="o">*</span> <span class="n">rv</span> <span class="o">-</span> <span class="mf">0.00033</span> <span class="o">*</span> <span class="n">rv</span><span class="o">**</span><span class="mi">2</span> 
    <span class="c1"># WARNING : typo in F99 ?</span>
    <span class="c1"># See their Table 4 ... with &#39;-1.208&#39;, it doesn&#39;t work !</span>

    <span class="c1"># ---- For the IR anchors ----</span>
    <span class="n">ir_spline</span> <span class="o">=</span> <span class="n">rv</span><span class="o">/</span><span class="mf">3.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.265</span><span class="p">,</span><span class="mf">0.829</span><span class="p">])</span>
    
    <span class="c1"># Ok, now, perform the spline interpolation</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ir_anchors</span><span class="p">,</span> <span class="n">optical_anchors</span><span class="p">),</span> <span class="n">uv_anchors</span><span class="p">)</span>
    <span class="n">alebv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ir_spline</span><span class="p">,</span> <span class="n">optical_spline</span><span class="p">),</span> <span class="n">uv_spline</span><span class="p">)</span>   
    <span class="n">interp_func</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">alebv</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> 
                                       <span class="n">bounds_error</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span> 
    <span class="c1"># bounds_error = False -&gt; Will return a NaN is outside the allowed range </span>
    
    <span class="c1"># Finally, compute the value at the wavelengths of interest</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">my_lams</span><span class="p">)</span>
    
    <span class="c1"># If lam &gt; 2700, use the spline function</span>
    <span class="n">out</span><span class="p">[</span><span class="n">lams</span><span class="o">&gt;</span><span class="mi">2700</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp_func</span><span class="p">(</span><span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&gt;</span><span class="mi">2700</span><span class="p">])</span>
    <span class="c1"># If lam &lt;= 2700, use the fm90 function</span>
    <span class="n">Dl</span> <span class="o">=</span> <span class="n">D_fm90</span><span class="p">(</span><span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">],</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">Fl</span> <span class="o">=</span> <span class="n">F_fm90</span><span class="p">(</span><span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">])</span>
    <span class="n">out</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">]</span> <span class="o">=</span> <span class="n">rv</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">]</span> <span class="o">+</span> <span class="n">c3</span> <span class="o">*</span> <span class="n">Dl</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">*</span> <span class="n">Fl</span>
    
    <span class="k">return</span> <span class="n">out</span>  </div>
<span class="c1"># ----------------------------------------------------------------------------------------  </span>
<span class="c1"># TODO</span>
<span class="c1"># Get E_lambda-V/E_B-V following Fischera &amp; Dopita05, Vogt et al. (2013)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">def fd05_elvebv(lams): # lams in Angstroem</span>
<span class="sd"># Make sure this is an array (for the overall consistency)</span>
<span class="sd">    try :</span>
<span class="sd">        len(lams)</span>
<span class="sd">    except :</span>
<span class="sd">        lams = np.array([lams])</span>
<span class="sd">    </span>
<span class="sd">    my_lams = 1.0e4/lams    </span>
<span class="sd">    out = -4.61777 + 1.41612 * my_lams + 1.52077 * my_lams**2 \</span>
<span class="sd">        - 0.63269 * my_lams**3 +0.07386 * my_lams**4    </span>
<span class="sd">      # WARNING : this is ONLY valid over the range 3000&lt;lambda&lt;12000 !</span>
<span class="sd">      # Make it return &#39;NaN&#39; elsewhere    </span>
<span class="sd">    out[lams&gt;12390] = np.nan</span>
<span class="sd">    out[lams&lt;2480] = np.nan</span>
<span class="sd">    </span>
<span class="sd">    return out</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># ----------------------------------------------------------------------------------------  </span>

<div class="viewcode-block" id="cal00_ke"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.cal00_ke">[docs]</a><span class="k">def</span> <span class="nf">cal00_ke</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The Calzetti (2000) law. lams in Angstroem.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># Make sure lams is an array (for the overall consistency)</span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">lams</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="n">lams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lams</span><span class="p">])</span>
    
    <span class="n">my_lams</span> <span class="o">=</span> <span class="mf">1.0e4</span><span class="o">/</span><span class="n">lams</span>             
    <span class="n">ke</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lams</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&lt;</span> <span class="mf">0.63</span> <span class="ow">and</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&gt;=</span> <span class="mf">0.12</span> <span class="p">:</span>
            <span class="n">ke</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.659</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.156</span> <span class="o">+</span><span class="mf">1.509</span> <span class="o">*</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.198</span><span class="o">*</span><span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                             <span class="mf">0.011</span> <span class="o">*</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">rv</span>
        <span class="k">elif</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&lt;</span> <span class="mf">2.20</span> <span class="ow">and</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&gt;=</span> <span class="mf">0.63</span> <span class="p">:</span>
            <span class="n">ke</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.659</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.857</span> <span class="o">+</span><span class="mf">1.040</span> <span class="o">*</span><span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">rv</span>
    <span class="k">return</span> <span class="n">ke</span> </div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<span class="c1"># Following Cardelli, Clayton &amp; Mathis (1989)</span>
<div class="viewcode-block" id="ccm89_alav"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.ccm89_alav">[docs]</a><span class="k">def</span> <span class="nf">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">rv</span><span class="p">):</span> <span class="c1"># lams in Angstroem</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The law from Caredelli, CLayton and Mathis (1989). lams in Angstroem.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># Make sure lams is an array </span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">lams</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="n">lams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lams</span><span class="p">])</span>

    <span class="n">my_lams</span> <span class="o">=</span> <span class="mf">1.0e4</span><span class="o">/</span><span class="n">lams</span>
    
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="n">alav</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_lams</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="mf">0.3</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">1.1</span> <span class="p">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.574</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">1.61</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.527</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">1.61</span>
        <span class="k">elif</span> <span class="mf">1.1</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">3.3</span> <span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="mf">1.82</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.17699</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span><span class="mf">0.50447</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.02427</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>\
                <span class="mf">0.72085</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">0.01979</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="mf">0.77530</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="mf">0.32999</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">7</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.41338</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">2.28305</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">1.07233</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">5.38434</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>\
                <span class="mf">0.62251</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mf">5.30260</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mf">2.09002</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="mf">3.3</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;=</span> <span class="mi">8</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">5.9</span> <span class="p">:</span> 
                <span class="n">fa</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">fb</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">fa</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04473</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.009779</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
                <span class="n">fb</span> <span class="o">=</span>  <span class="mf">0.2130</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.1207</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.752</span> <span class="o">-</span> <span class="mf">0.316</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.104</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mf">4.67</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.341</span><span class="p">)</span> <span class="o">+</span> <span class="n">fa</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.090</span> <span class="o">+</span> <span class="mf">1.825</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.206</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mf">4.62</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.263</span><span class="p">)</span> <span class="o">+</span> <span class="n">fb</span>
    
    <span class="n">alav</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">/</span><span class="n">rv</span>

    <span class="k">return</span> <span class="n">alav</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="alam"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.alam">[docs]</a><span class="k">def</span> <span class="nf">alam</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">ab</span><span class="p">,</span><span class="n">av</span><span class="p">,</span><span class="n">curve</span><span class="o">=</span><span class="s1">&#39;f99&#39;</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cal00_stellar</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate the value of A_lambda for different curves -&gt; bring everyone together !</span>
<span class="sd">    Input : lambda(angstroem), ab &amp; av (e.g. from NED), rv and extinction curve</span>
<span class="sd">            cal00_stellar (True/False), whethert o add the 0.44 correction factor for </span>
<span class="sd">            stellar extinction (vs gas)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;f99&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ab</span><span class="o">-</span><span class="n">av</span><span class="p">)</span> 
        <span class="k">return</span> <span class="n">out</span>
        
    <span class="c1">#if curve == &#39;fd05&#39;:</span>
    <span class="c1">#    # From Fischera&amp; Dopita (2005), see also Vogt et al. (2013)</span>
    <span class="c1">#    rv = 4.5     </span>
    <span class="c1">#    red = fd05_elvebv(lams)</span>
    <span class="c1">#    return (red + rv)*(ab-av)</span>
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;cal00&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">4.05</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">cal00_stellar</span><span class="p">:</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="mf">0.44</span>
        <span class="k">return</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ab</span><span class="o">-</span><span class="n">av</span><span class="p">)</span><span class="o">*</span><span class="n">corr</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span><span class="s1">&#39;ccm89&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="k">return</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span><span class="o">*</span><span class="n">av</span>      </div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="galactic_red"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.galactic_red">[docs]</a><span class="k">def</span> <span class="nf">galactic_red</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">ab</span><span class="p">,</span><span class="n">av</span><span class="p">,</span><span class="n">curve</span><span class="o">=</span><span class="s1">&#39;f99&#39;</span><span class="p">,</span><span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span><span class="p">,</span> <span class="n">cal00_stellar</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate galactic reddening (flux_ratio). </span>
<span class="sd">    Input: curve (which function) and lams, the wavelength in Angstroem,</span>
<span class="sd">    ab and av, the extinction from NED</span>
<span class="sd">    Return F unreddened/ F observed</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">alam</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">ab</span><span class="p">,</span><span class="n">av</span><span class="p">,</span><span class="n">curve</span><span class="o">=</span><span class="n">curve</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="n">rv</span><span class="p">,</span> <span class="n">cal00_stellar</span><span class="o">=</span><span class="n">cal00_stellar</span><span class="p">)</span> <span class="o">*</span> \
          <span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span>
          
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="extragalactic_red"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.extragalactic_red">[docs]</a><span class="k">def</span> <span class="nf">extragalactic_red</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">ha_hb</span><span class="p">,</span><span class="n">ha_hb_0</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="s1">&#39;fd05&#39;</span><span class="p">,</span> <span class="n">rv</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate extragalactic reddening (based on Halpha/Hbeta) </span>
<span class="sd">    Input: wavelengths (angstroem), Halpha/Hbeta (observed), </span>
<span class="sd">    Halpha/Hbeta (reference), extinction curve, rv</span>
<span class="sd">    Return F unreddened/ F observed</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#if curve == &#39;fd05&#39; :</span>
    <span class="c1">#    elvebv = fd05_elvebv(lam)</span>
    <span class="c1">#    ehavebv = fd05_elvebv(halpha)	</span>
    <span class="c1">#    ehbvebv = fd05_elvebv(hbeta) </span>
    <span class="c1">#    out = (ha_hb/ha_hb_0)**(-(elvebv+4.5)/(ehavebv-ehbvebv))  </span>
    <span class="c1">#    return out</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;ccm89&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="n">alav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="n">aHaav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ha_hb</span><span class="o">/</span><span class="n">ha_hb_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alav</span><span class="o">/</span><span class="p">(</span><span class="n">aHaav</span><span class="o">-</span><span class="n">aHbav</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;cal00&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">4.05</span>
        <span class="n">ke</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">keHa</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">halpha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">keHb</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">hbeta</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ha_hb</span><span class="o">/</span><span class="n">ha_hb_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">ke</span><span class="o">/</span><span class="p">(</span><span class="n">keHa</span><span class="o">-</span><span class="n">keHb</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;f99&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">3.1</span>
        <span class="n">alebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">aHaebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">halpha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">hbeta</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ha_hb</span><span class="o">/</span><span class="n">ha_hb_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alebv</span><span class="o">/</span><span class="p">(</span><span class="n">aHaebv</span><span class="o">-</span><span class="n">aHbebv</span><span class="p">))</span></div>
<span class="c1"># ----------------------------------------------------------------------------------------         </span>

<div class="viewcode-block" id="hahb_to_av"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.hahb_to_av">[docs]</a><span class="k">def</span> <span class="nf">hahb_to_av</span><span class="p">(</span><span class="n">ha_hb</span><span class="p">,</span><span class="n">ha_hb_0</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="s1">&#39;fd05&#39;</span><span class="p">,</span> <span class="n">rv</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A function to get the reddening in Av mag, from Ha/Hb ratio</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#if curve == &#39;fd05&#39; :</span>
    <span class="c1">#    ehavebv = fd05_elvebv(halpha)	</span>
    <span class="c1">#    ehbvebv = fd05_elvebv(hbeta) </span>
    <span class="c1">#    out = -2.5*np.log10(ha_hb/ha_hb_0)*(4.5/(ehavebv-ehbvebv))  </span>
    <span class="c1">#    return out</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;ccm89&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="n">aHaav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ha_hb</span><span class="o">/</span><span class="n">ha_hb_0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">aHaav</span><span class="o">-</span><span class="n">aHbav</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;cal00&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">4.05</span>
        <span class="n">keHa</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">halpha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">keHb</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">hbeta</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ha_hb</span><span class="o">/</span><span class="n">ha_hb_0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="p">(</span><span class="n">keHa</span><span class="o">-</span><span class="n">keHb</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;f99&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">3.1</span>
        <span class="n">aHaebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ha_hb</span><span class="o">/</span><span class="n">ha_hb_0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="p">(</span><span class="n">aHaebv</span><span class="o">-</span><span class="n">aHbebv</span><span class="p">))</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="check"><a class="viewcode-back" href="../modules/brian_red.html#brian_red.check">[docs]</a><span class="k">def</span> <span class="nf">check</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Make some quick plots to test the reddening functions of BRIAN, by comparing with</span>
<span class="sd">    the original papers. ANd make sure I did not mess things up ...</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># 1) Check Cardelli89 and Fitzpatrick99: reproduce Fig. 7 of Fitzpatrick99    </span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">8.75</span><span class="p">,</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">lams</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="mf">1.e4</span>
     
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span> <span class="p">)</span>
     
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
     
    <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
     
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">2.3</span><span class="p">,</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">]):</span>
        <span class="n">f99_curve</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span>
        <span class="n">ccm89_curve</span> <span class="o">=</span> <span class="p">(</span><span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span><span class="n">r</span>
        
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f99_curve</span><span class="p">,</span><span class="n">ls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">r&#39;R$_V$ = &#39;</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ccm89_curve</span><span class="p">,</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">r&#39;1/$\lambda$ [$\mu$m$^{-1}$]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">r&#39;E($\lambda$-V)/E(B-V)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="s1">&#39;Fitzpatrick (1999) - Fig. 7; F99 (-) vs CCM89 (- -)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
    <span class="c1"># Add the MUSE range because I can</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">4750.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">9350.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="s1">r&#39;MUSE range (4750\AA $\rightarrow$ 9350\AA)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># --------------------------------------------------------------------------</span>
    <span class="c1"># 2) Compare with Fischera &amp; Dopita 2005  </span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    x = np.arange(0.0001,7.5,0.1)</span>
<span class="sd">    lams = 1/x*1.e4</span>
<span class="sd">     </span>
<span class="sd">    plt.close(2)</span>
<span class="sd">    plt.figure(2, figsize=(10,8))</span>
<span class="sd">    gs = gridspec.GridSpec(2,1, height_ratios=[1,0.5], width_ratios=[1])</span>
<span class="sd">    gs.update(left=0.15,right=0.9,bottom=0.1,top=0.95,wspace=0.05,hspace=0.05 )</span>
<span class="sd">    </span>
<span class="sd">    r = 3.1</span>
<span class="sd">    f99_curve = f99_alebv(lams,r) - r</span>
<span class="sd">    ccm89_curve = (ccm89_alav(lams,r)*r) -r</span>
<span class="sd">    cal00_curve = cal00_ke(lams,4.05) - 4.05   </span>
<span class="sd">    fd05_curve = fd05_elvebv(lams)</span>
<span class="sd">    </span>
<span class="sd">    ax1 = plt.subplot(gs[0,0])</span>
<span class="sd">    ax1.plot(x,f99_curve,&#39;r-&#39;, linewidth=1,label=r&#39;F99, R$_V$=&#39;+np.str(r))</span>
<span class="sd">    ax1.plot(x,ccm89_curve,&#39;g-&#39;,label=r&#39;CCM89, R$_V$=&#39;+np.str(r))</span>
<span class="sd">    ax1.plot(x,cal00_curve,&#39;b-&#39;,label=r&#39;Cal00, R$_V$=4.05&#39;)</span>
<span class="sd">    ax1.plot(x,fd05_curve,&#39;k--&#39;,linewidth=2, label=&#39;FD05, R$_V$$^{A}$=4.5&#39;)</span>
<span class="sd">    ax1.grid(True)</span>
<span class="sd">    ax1.set_xticklabels([])</span>
<span class="sd">    ax1.set_ylabel(r&#39;E($\lambda$-V)/E(B-V)&#39;)</span>
<span class="sd">    ax1.legend(loc=&#39;lower right&#39;,fontsize=15)</span>
<span class="sd">    ax1.set_xlim([0.5,4.5])</span>
<span class="sd">    ax1.set_ylim([-5,5])</span>
<span class="sd">    </span>
<span class="sd">    ax2 = plt.subplot(gs[1,0])</span>
<span class="sd">    ax2.axhline(y=0,color =(0.4,0.4,0.4), linewidth=2)</span>
<span class="sd">    ax2.plot(x,f99_curve-fd05_curve,&#39;r-&#39;, linewidth=1,label=r&#39;F99, R$_V$=&#39;+np.str(r))</span>
<span class="sd">    ax2.plot(x,ccm89_curve-fd05_curve,&#39;g-&#39;,label=r&#39;CCM89, R$_V$=&#39;+np.str(r))</span>
<span class="sd">    ax2.plot(x,cal00_curve-fd05_curve,&#39;b-&#39;,label=r&#39;Cal00, R$_V$=&#39;+np.str(r))    </span>
<span class="sd">    ax2.grid(True)</span>
<span class="sd">    ax2.set_ylabel(r&#39;$\Delta$E($\lambda$-V)/E(B-V)&#39;)</span>
<span class="sd">    #ax2.legend(loc=&#39;lower right&#39;)</span>
<span class="sd">    ax2.set_xlim([0.5,4.5])</span>
<span class="sd">    #ax1.ylim([-5,5])</span>
<span class="sd">    ax2.set_xlabel(r&#39;1/$\lambda$ [$\mu$m$^{-1}$]&#39;)</span>
<span class="sd">       </span>
<span class="sd">    plt.show()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># --------------------------------------------------------------------------</span>
    <span class="c1"># 3) Reproduce Fig.1 of Calzetti (2001) </span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">lams</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="mf">1.e4</span>
     
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span> <span class="p">)</span>
    
    <span class="n">f99_2</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">f99_31</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">3.1</span><span class="p">)</span>
    <span class="n">f99_5</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">ccm89_2</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="mf">2.0</span>
    <span class="n">ccm89_31</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">3.1</span><span class="p">)</span><span class="o">*</span><span class="mf">3.1</span>
    <span class="n">ccm89_5</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">5.0</span><span class="p">)</span><span class="o">*</span><span class="mf">5.0</span>
    <span class="c1">#ccm89_curve = (ccm89_alav(lams,r)*r) -r</span>
    <span class="n">cal00_curve</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">4.05</span><span class="p">)</span>   
    <span class="c1">#fd05_curve = fd05_elvebv(lams)+4.5</span>
    
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">f99_2</span><span class="p">,</span><span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=2.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">f99_31</span><span class="p">,</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=3.1&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">f99_5</span><span class="p">,</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=5.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">ccm89_2</span><span class="p">,</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=2.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">ccm89_31</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=3.1&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">ccm89_5</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=5.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">cal00_curve</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;Cal00, R$_V$=4.05&#39;</span><span class="p">)</span>
    <span class="c1">#ax1.plot(np.log10(lams/1.e4),fd05_curve,&#39;k--&#39;,linewidth=2, label=&#39;FD05, R$_{V}$$^{A}$=4.5&#39;)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">r&#39;A$_\lambda$/E(B-V)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">r&#39;log[$\lambda$($\mu$m)]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
    
    <span class="c1"># Add the MUSE range because I can</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">4750.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">9350.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">8.1</span><span class="p">,</span><span class="s1">r&#39;MUSE range (4750\AA $\rightarrow$ 9350\AA)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
       
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
<span class="c1"># ----------------------------------------------------------------------------------------</span>


</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Frdric P.A. Vogt.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>